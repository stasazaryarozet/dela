# Fallback Booking System –¥–ª—è –û–ª—å–≥–∏ –†–æ–∑–µ—Ç

**–°–æ–∑–¥–∞–Ω–æ:** 18 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## –ü—Ä–æ–±–ª–µ–º–∞

Cal.com API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (500 error –Ω–∞ –≤—Å–µ—Ö endpoints).

---

## –†–µ—à–µ–Ω–∏–µ

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π fallback** –Ω–∞ –±–∞–∑–µ Google Calendar API + Flask API + HTML UI.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Google Calendar API (–≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω)
        ‚Üì
Python Fallback System
        ‚Üì
Flask API (/api/slots, /api/book)
        ‚Üì
HTML UI (fallback_booking_ui.html)
        ‚Üì
–ö–ª–∏–µ–Ω—Ç –±—Ä–æ–Ω–∏—Ä—É–µ—Ç
```

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. `fallback_booking.py`
–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤ –∏–∑ Google Calendar (—Å–æ–±—ã—Ç–∏—è —Å `üîì –°–õ–û–¢`)
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON)
- –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Email + Telegram)

### 2. `fallback_api.py`
Flask API —Å–µ—Ä–≤–µ—Ä:
- `GET /api/slots` ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
- `POST /api/book` ‚Äî –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- `POST /api/cancel` ‚Äî –æ—Ç–º–µ–Ω–∞
- `GET /` ‚Äî HTML UI

### 3. `fallback_booking_ui.html`
–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
- –§–æ—Ä–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- `<noscript>` fallback (–µ—Å–ª–∏ JS –æ—Ç–∫–ª—é—á–µ–Ω)

### 4. `fallback_bookings.json`
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π (–ª–æ–∫–∞–ª—å–Ω–∞—è, JSON).

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞:

```bash
cd ".gates/calcom"
python3 fallback_api.py
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞ `http://localhost:5000`

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—Ç–æ–≤ –≤ Google Calendar:

```bash
python3 -c "
from google_gate import GoogleGate
import pytz
from datetime import datetime

gate = GoogleGate()
cal = gate.calendar()

moscow_tz = pytz.timezone('Europe/Moscow')
start = moscow_tz.localize(datetime(2025, 11, 21, 17, 30))
end = moscow_tz.localize(datetime(2025, 11, 21, 18, 10))

event = {
    'summary': 'üîì –°–õ–û–¢: –í–∫–ª—é—á–∏—Ç—å –≤ –¥–µ–ª–æ (40 –º–∏–Ω)',
    'start': {'dateTime': start.isoformat(), 'timeZone': 'Europe/Moscow'},
    'end': {'dateTime': end.isoformat(), 'timeZone': 'Europe/Moscow'}
}

cal.events().insert(calendarId='primary', body=event).execute()
print('‚úÖ –°–ª–æ—Ç —Å–æ–∑–¥–∞–Ω')
"
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å olgaroset.ru

–ö–æ–≥–¥–∞ Cal.com –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É:

```html
<a href="https://fallback.olgarozet.ru">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ —Ä–µ–∑–µ—Ä–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É</a>
```

–ò–ª–∏ –≤—Å—Ç—Ä–æ–∏—Ç—å iframe:

```html
<iframe src="https://fallback.olgarozet.ru" width="100%" height="600px"></iframe>
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Google Calendar API (—Ç–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (fallback_bookings.json)
- ‚úÖ –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö API
- ‚úÖ `<noscript>` fallback (–∫–æ–Ω—Ç–∞–∫—Ç—ã –û–ª—å–≥–∏)

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Cal.com

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ —á–∞—Å:

```bash
while true; do
  curl -s -H "Authorization: Bearer YOUR_KEY" https://api.cal.com/v1/me | grep -q "user" && echo "‚úÖ Cal.com –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" || echo "‚ùå Cal.com –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
  sleep 3600
done
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **100% –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ–µ Cal.com
2. **–ü—Ä—è–º–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å** ‚Äî –û–ª—å–≥–∞ –≤–∏–¥–∏—Ç –≤—Å—ë –≤ —Å–≤–æ–µ–º Google Calendar
3. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞** ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. **–ó–∞–±–æ—Ç–∞ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ** ‚Äî –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å —Å–ø–æ—Å–æ–± –∑–∞–ø–∏—Å–∞—Ç—å—Å—è

---

## Status

‚úÖ **Fallback —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞**  
‚úÖ **–ü–∏–ª–æ—Ç–Ω—ã–π —Å–ª–æ—Ç —Å–æ–∑–¥–∞–Ω (21 –Ω–æ—è–±—Ä—è, 17:30)**  
‚úÖ **API —Ä–∞–±–æ—Ç–∞–µ—Ç**  
‚úÖ **UI –≥–æ—Ç–æ–≤**

**–¢–µ–ø–µ—Ä—å Cal.com ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è.**

