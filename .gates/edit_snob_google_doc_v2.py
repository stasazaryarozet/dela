#!/usr/bin/env python3
"""
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Google Docs –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è "–°–Ω–æ–±" - –≤–µ—Ä—Å–∏—è 2
–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω–∞ –æ–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –≤–µ—Ä—Å–∏—é
"""
import os
import sys

sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'google'))
from google_gate import GoogleGate

DOC_ID = "1AfAFbklq2RCtOCtaKX_SPQTGNir2pMR9pq3V8Ggmhx4"

# –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (–æ–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è)
FINAL_TEXT = """–≠—Å—Ç–µ—Ç–∏–∫–∞ –∏—Å—á–µ–∑–∞—é—â–µ–≥–æ: –ø–æ—á–µ–º—É –≤ –º–∏—Ä–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —Ä–∞—Å—Ç–µ—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–≥–æ –∏ —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥–∞

–í —ç–ø–æ—Ö—É –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ 3D-–ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ —Ä—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞—Å—Ç–µ—Ç –≤ 2,5-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Ä—ã–Ω–∫–∞ –æ–¥–µ–∂–¥—ã. –ü–æ—á–µ–º—É –º—ã –≤—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–µ –≤–º–µ—Å—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ? –†–∞–∑–±–∏—Ä–∞–µ–º—Å—è –≤–º–µ—Å—Ç–µ —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã ¬´–î–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤¬ª –ë—Ä–∏—Ç–∞–Ω—Å–∫–æ–π –≤—ã—Å—à–µ–π —à–∫–æ–ª—ã –¥–∏–∑–∞–π–Ω–∞ –û–ª—å–≥–æ–π –†–æ–∑–µ—Ç.

–ü–æ –¥–∞–Ω–Ω—ã–º CEDEFOP, –≤ 2020 –≥–æ–¥—É –≤–æ –≤—Ä–µ–º—è Covid-19 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª—Å—è —Å–ø–∞–¥ –≤ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏. –ü—Ä–æ—Ä–æ—á–µ—Å—Ç–≤–∞ –æ –∫–æ–Ω—Ü–µ —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥–∞ –Ω–µ —Å–±—ã–ª–∏—Å—å. –ü–æ –ø—Ä–æ–≥–Ω–æ–∑–∞–º Future Market Insights, —Ä—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞—Å—Ç–µ—Ç –Ω–∞ 10% –≤ –≥–æ–¥ ‚Äî –≤ 2,5-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Ä—ã–Ω–∫–∞ –æ–¥–µ–∂–¥—ã. –í –ø—Ä–∏—á–∏–Ω–∞—Ö —Ç–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –º—ã —Ä–∞–∑–±–∏—Ä–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã ¬´–î–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤¬ª –ë—Ä–∏—Ç–∞–Ω—Å–∫–æ–π –≤—ã—Å—à–µ–π —à–∫–æ–ª—ã –¥–∏–∑–∞–π–Ω–∞ –û–ª—å–≥–æ–π –†–æ–∑–µ—Ç.

–ü—Ä–∏—á–∏–Ω—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞

–†–∞–∑–≤–∏—Ç–∏–µ —Å–æ—Ü—Å–µ—Ç–µ–π —É–≤–µ–ª–∏—á–∏–ª–æ –æ–±—ä–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∏–¥–µ–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤.

–†—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞—Å—Ç–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —Ä—ã–Ω–∫–∞ –æ–¥–µ–∂–¥—ã: 10% –ø—Ä–æ—Ç–∏–≤ 2-4% –≥–æ–¥ –∫ –≥–æ–¥—É.

–í—ã—Ä—É—á–∫–∞ IKEA (Ingka Group) –≤ 2024 –≥–æ–¥—É —Å–Ω–∏–∑–∏–ª–∞—Å—å[a] –Ω–∞ 2,5 –º–ª—Ä–¥ –µ–≤—Ä–æ. IKEA –æ—Å—Ç–∞–µ—Ç—Å—è –∫—Ä—É–ø–Ω–µ–π—à–∏–º –∏–≥—Ä–æ–∫–æ–º –Ω–∞ —Ä—ã–Ω–∫–µ –º–µ–±–µ–ª–∏.

–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –¥–∏–∑–∞–π–Ω–∞

–ü–æ –¥–∞–Ω–Ω—ã–º TechSci Research, —Ç–µ–º–ø —Ä–æ—Å—Ç–∞ —Ä—ã–Ω–∫–∞ –º–µ–±–µ–ª–∏ –Ω–∞ –∑–∞–∫–∞–∑ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 7%, –ø—Ä–æ–≥–Ω–æ–∑ —Ä–æ—Å—Ç–∞ ‚Äî –≤ 1,5 —Ä–∞–∑–∞ –∫ 2030 –≥–æ–¥—É[b].

–û–±—â–∏–π –æ–±—ä–µ–º —Ä—ã–Ω–∫–∞ –∫ 2030 –≥–æ–¥—É –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—Å–∏—Ç—å $24 –º–ª—Ä–¥ ‚Äî 2% –æ—Ç –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–º–∞[c] —Ä—ã–Ω–∫–∞ –º–µ–±–µ–ª–∏. –¢–µ–º–ø —Ä–æ—Å—Ç–∞ 7% –æ–ø–µ—Ä–µ–∂–∞–µ—Ç –æ–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –≤ 5%.

–°–ø—Ä–æ—Å –Ω–∞ –º–µ–±–µ–ª—å —Ä–∞—Å—Ç–µ—Ç –≤ —Ä–∞–∑–≤–∏–≤–∞—é—â–∏—Ö—Å—è —Å—Ç—Ä–∞–Ω–∞—Ö (–Ω–∏–∑–∫–∞—è —Ü–µ–Ω–∞, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å). –°–ø—Ä–æ—Å –Ω–∞ —Ä—É—á–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è –∑–∞–º–µ—Ç–µ–Ω –Ω–∞ —Ä—ã–Ω–∫–∞—Ö –≤—ã—Å–æ–∫–æ–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

–ú–∞—Ç–µ—Ä–∏–∞–ª—ã: —Ç–µ–∫—Å—Ç–∏–ª—å, –∫–µ—Ä–∞–º–∏–∫–∞, –¥–µ—Ä–µ–≤–æ. –ß–∞—Å—Ç–æ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã, –¥–æ–ª–≥–æ–≤–µ—á–Ω—ã, –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω—ã. –†—É—á–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è —á–∞—Å—Ç–æ –¥–æ—Ä–æ–∂–µ –º–∞—Å—Å–æ–≤—ã—Ö. –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –º–æ–∂–µ—Ç –Ω–∞–Ω–æ—Å–∏—Ç—å –≤—Ä–µ–¥ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–µ.

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ, –º–µ–Ω–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –¥–æ—Ä–æ–∂–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Ç–µ—Ä—è–Ω—ã –±–µ–∑ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.

–û—Ç—Ä–∞–∂–µ–Ω–∏–µ —ç—Å—Ç–µ—Ç–∏–∫–∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞ –≤ –≤–∏–Ω—Ç–∞–∂–Ω–æ–π –º–µ–±–µ–ª–∏ –∏ –ø—Ä–µ–¥–º–µ—Ç–∞—Ö –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞

–ü–æ –¥–∞–Ω–Ω—ã–º ¬´–ê–≤–∏—Ç–æ¬ª, –≤ Q1 2025 —Å–ø—Ä–æ—Å –Ω–∞ –≤–∏–Ω—Ç–∞–∂–Ω—É—é –º–µ–±–µ–ª—å –∏ –¥–µ–∫–æ—Ä –≤—ã—Ä–æ—Å –Ω–∞ 27%. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: –ª—é—Å—Ç—Ä—ã –∏ –ª–∞–º–ø—ã, –≥—Ä–∞—Ñ–∏–∫–∞ –∏ –ø–æ—Å—Ç–µ—Ä—ã, —Ç–µ–∫—Å—Ç–∏–ª—å, –∫–æ–≤—Ä—ã, —Å—Ç–æ–ª—ã –∏ —Å—Ç—É–ª—å—è.

–†–æ—Å—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏–ª–∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏.

–í–∏–Ω—Ç–∞–∂ —á–∞—Å—Ç–æ –¥–æ—Ä–æ–∂–µ –∏ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏. –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Ä–µ–¥–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (—Å–≤–∏–Ω–µ—Ü, —Ñ–æ—Ä–º–∞–ª—å–¥–µ–≥–∏–¥), —Ç—Ä–µ–±—É–µ—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–æ–ª–≥–æ–≤–µ—á–Ω—ã–µ –≤–µ—â–∏ —á–∞—Å—Ç–æ –¥–æ—Ä–æ–∂–µ, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø –¥–ª—è –ª—é–¥–µ–π —Å –Ω–∏–∑–∫–∏–º –¥–æ—Ö–æ–¥–æ–º.

–†—ã–Ω–æ–∫ –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–º–µ—Ä—ã —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–æ–≤ —Å –Ω–∏–∑–∫–æ–π –æ–ø–ª–∞—Ç–æ–π. –ò–º–∏—Ç–∞—Ü–∏—è —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å–ø–µ—à–Ω–æ–π –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏ –±–µ–∑ –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —á–∞—Å—Ç–æ –¥–µ–∫–ª–∞—Ä–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è: –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä—É—á–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –º–æ–∂–µ—Ç –Ω–∞–Ω–æ—Å–∏—Ç—å –≤—Ä–µ–¥ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

[a] https://www.ingka.com/newsroom/ingka-group-prioritises-affordability-and-long-term-business-resilience-recording-eur-41-8-billion-in-revenue/

[b] https://www.techsciresearch.com/report/bespoke-furniture-market/28454.html

[c] https://www.grandviewresearch.com/horizon/outlook/furniture-market-size/global"""

def replace_document_content():
    """–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
    print("=" * 80)
    print("–ü–û–õ–ù–ê–Ø –ó–ê–ú–ï–ù–ê –°–û–î–ï–†–ñ–ò–ú–û–ì–û GOOGLE DOCS")
    print("=" * 80)
    print()
    
    gate = GoogleGate(
        credentials_path=os.path.join(os.path.dirname(__file__), 'google', 'credentials.json'),
        token_path=os.path.join(os.path.dirname(__file__), 'google', 'token.pickle')
    )
    
    docs_service = gate.docs()
    
    print(f"üìÑ –†–µ–¥–∞–∫—Ç–∏—Ä—É—é –¥–æ–∫—É–º–µ–Ω—Ç: {DOC_ID}")
    print()
    
    # –ü–æ–ª—É—á–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
    doc = docs_service.documents().get(documentId=DOC_ID).execute()
    body = doc.get('body', {})
    content = body.get('content', [])
    
    # –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å –∫–æ–Ω—Ü–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–ø–µ—Ä–µ–¥ –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º)
    if content:
        # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏–Ω–¥–µ–∫—Å
        last_index = 1
        for element in content:
            if 'endIndex' in element:
                last_index = element['endIndex']
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (–Ω–∞—á–∞–ª–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞)
        requests = [{
            'deleteContentRange': {
                'range': {
                    'startIndex': 1,
                    'endIndex': last_index - 1
                }
            }
        }]
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç
        requests.append({
            'insertText': {
                'location': {
                    'index': 1
                },
                'text': FINAL_TEXT
            }
        })
        
        print(f"üìù –ó–∞–º–µ–Ω—è—é —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞...")
        print()
        
        try:
            result = docs_service.documents().batchUpdate(
                documentId=DOC_ID,
                body={'requests': requests}
            ).execute()
            
            print("‚úÖ –î–æ–∫—É–º–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω!")
            print(f"‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π: {len(result.get('replies', []))}")
            print()
            print("üìÑ –î–æ–∫—É–º–µ–Ω—Ç: https://docs.google.com/document/d/" + DOC_ID)
            return True
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞")
        return False

if __name__ == '__main__':
    success = replace_document_content()
    sys.exit(0 if success else 1)


