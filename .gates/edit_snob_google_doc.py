#!/usr/bin/env python3
"""
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Google Docs –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è "–°–Ω–æ–±"
–í–Ω–æ—Å–∏—Ç –ø—Ä–∞–≤–∫–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Google Docs API
"""
import os
import sys

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ google gate
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'google'))
from google_gate import GoogleGate

DOC_ID = "1AfAFbklq2RCtOCtaKX_SPQTGNir2pMR9pq3V8Ggmhx4"

def edit_google_doc():
    """–í–Ω–µ—Å—Ç–∏ –ø—Ä–∞–≤–∫–∏ –≤ Google Docs –¥–æ–∫—É–º–µ–Ω—Ç"""
    print("=" * 80)
    print("–†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï GOOGLE DOCS –î–õ–Ø '–°–ù–û–ë'")
    print("=" * 80)
    print()
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Google Gate
    gate = GoogleGate(
        credentials_path=os.path.join(os.path.dirname(__file__), 'google', 'credentials.json'),
        token_path=os.path.join(os.path.dirname(__file__), 'google', 'token.pickle')
    )
    
    docs_service = gate.docs()
    
    print(f"üìÑ –†–µ–¥–∞–∫—Ç–∏—Ä—É—é –¥–æ–∫—É–º–µ–Ω—Ç: {DOC_ID}")
    print()
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    doc = docs_service.documents().get(documentId=DOC_ID).execute()
    
    # –°–æ–∑–¥–∞–µ–º batchUpdate –∑–∞–ø—Ä–æ—Å—ã
    requests = []
    
    # 1. –î–æ–±–∞–≤–∏—Ç—å –ª–∏–¥ –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    # –ù–∞—Ö–æ–¥–∏–º –∫–æ–Ω–µ—Ü –∑–∞–≥–æ–ª–æ–≤–∫–∞ (–ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
    body = doc.get('body', {})
    content = body.get('content', [])
    
    # –ò—â–µ–º –ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Å —Ç–µ–∫—Å—Ç–æ–º (–ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
    insert_index = 1  # –ü–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ª–∏–¥ –∫–∞–∫ –Ω–æ–≤—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ
    lead_text = "–í —ç–ø–æ—Ö—É –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ 3D-–ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ —Ä—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞—Å—Ç–µ—Ç –≤ 2,5-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Ä—ã–Ω–∫–∞ –æ–¥–µ–∂–¥—ã. –ü–æ—á–µ–º—É –º—ã –≤—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–µ –≤–º–µ—Å—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ? –†–∞–∑–±–∏—Ä–∞–µ–º—Å—è –≤–º–µ—Å—Ç–µ —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã ¬´–î–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤¬ª –ë—Ä–∏—Ç–∞–Ω—Å–∫–æ–π –≤—ã—Å—à–µ–π —à–∫–æ–ª—ã –¥–∏–∑–∞–π–Ω–∞ –û–ª—å–≥–æ–π –†–æ–∑–µ—Ç."
    
    requests.append({
        'insertText': {
            'location': {
                'index': insert_index
            },
            'text': lead_text + '\n\n'
        }
    })
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –ª–∏–¥ –∂–∏—Ä–Ω—ã–º
    # –ù–∞–π–¥–µ–º –∏–Ω–¥–µ–∫—Å –Ω–∞—á–∞–ª–∞ –ª–∏–¥–∞ –ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏
    requests.append({
        'updateTextStyle': {
            'range': {
                'startIndex': insert_index,
                'endIndex': insert_index + len(lead_text)
            },
            'textStyle': {
                'bold': True
            },
            'fields': 'bold'
        }
    })
    
    # 2. –ó–∞–º–µ–Ω–∏—Ç—å –ø–µ—Ä–≤—ã–π –∞–±–∑–∞—Ü
    # –ù–∞—Ö–æ–¥–∏–º –∏ –∑–∞–º–µ–Ω—è–µ–º –¥–ª–∏–Ω–Ω—ã–π –ø–µ—Ä–≤—ã–π –∞–±–∑–∞—Ü
    old_text = "–ü–æ –¥–∞–Ω–Ω—ã–º CEDEFOP, –ø—è—Ç—å –ª–µ—Ç –Ω–∞–∑–∞–¥ –≤–æ –≤—Ä–µ–º—è Covid-19 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª—Å—è —Å–ø–∞–¥ –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —á–∏—Å–ª–∞ —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç –≤ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏, –∏ –≥–ª–∞–≤—ã –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–π –ø—Ä–æ—Ä–æ—á–∏–ª–∏ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç–µ —É—Ö–æ–¥ –≤ –∏—Å—Ç–æ—Ä–∏—é. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ –ø—Ä–æ—Ä–æ—á–µ—Å—Ç–≤–∞, –∫–∞–∫ —ç—Ç–æ —á–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç, –Ω–µ —Å–±—ã–ª–∏—Å—å. –ü–æ –ø—Ä–æ–≥–Ω–æ–∑–∞–º Future Market Insights, —Ä—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö, —Ç–æ –µ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —Å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ–º —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥–∞ —Ç–æ–≤–∞—Ä–æ–≤ –±—É–¥–µ—Ç —Ä–∞—Å—Ç–∏ —Å–æ —Å—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤—ã–º —Ç–µ–º–ø–æ–º –≤ 10%, –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: –º–∏—Ä–æ–≤–æ–π —Ä—ã–Ω–æ–∫ –æ–¥–µ–∂–¥—ã —Ä–∞—Å—Ç–µ—Ç —Å —Ç–µ–º–ø–æ–º 2-4% –≥–æ–¥ –∫ –≥–æ–¥—É. –ü–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ –≤ –ø–µ—Ä–∏–æ–¥, –∫–æ–≥–¥–∞ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞ 3D-–ø—Ä–∏–Ω—Ç–µ—Ä—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç –æ–±—ä–µ–∫—Ç—ã —Å –º–∏–∫—Ä–æ–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é, –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –¥—É—à–µ–≤–Ω–æ—Å—Ç—å –≤–º–µ—Å—Ç–æ –¥–µ—à–µ–≤–∏–∑–Ω—ã –≤ –ø—Ä–æ—Ç–∏–≤–æ–≤–µ—Å –≤—Å–µ–º –∑–∞–∫–æ–Ω–∞–º —ç–∫–æ–Ω–æ–º–∏–∫–∏  –∏ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –í –ø—Ä–∏—á–∏–Ω–∞—Ö —Ç–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –º—ã —Ä–∞–∑–±–∏—Ä–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã ¬´–î–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤¬ª –ë—Ä–∏—Ç–∞–Ω—Å–∫–æ–π –≤—ã—Å—à–µ–π —à–∫–æ–ª—ã –¥–∏–∑–∞–π–Ω–∞ –û–ª—å–≥–æ–π –†–æ–∑–µ—Ç"
    
    new_text = "–ü–æ –¥–∞–Ω–Ω—ã–º CEDEFOP, –≤ 2020 –≥–æ–¥—É –≤–æ –≤—Ä–µ–º—è Covid-19 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª—Å—è —Å–ø–∞–¥ –≤ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏. –ü—Ä–æ—Ä–æ—á–µ—Å—Ç–≤–∞ –æ –∫–æ–Ω—Ü–µ —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥–∞ –Ω–µ —Å–±—ã–ª–∏—Å—å. –ü–æ –ø—Ä–æ–≥–Ω–æ–∑–∞–º Future Market Insights, —Ä—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞—Å—Ç–µ—Ç –Ω–∞ 10% –≤ –≥–æ–¥ ‚Äî –≤ 2,5-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —Ä—ã–Ω–∫–∞ –æ–¥–µ–∂–¥—ã. –í –ø—Ä–∏—á–∏–Ω–∞—Ö —Ç–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –º—ã —Ä–∞–∑–±–∏—Ä–∞–ª–∏—Å—å –≤–º–µ—Å—Ç–µ —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã ¬´–î–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–≤¬ª –ë—Ä–∏—Ç–∞–Ω—Å–∫–æ–π –≤—ã—Å—à–µ–π —à–∫–æ–ª—ã –¥–∏–∑–∞–π–Ω–∞ –û–ª—å–≥–æ–π –†–æ–∑–µ—Ç."
    
    # –ù–∞–π–¥–µ–º —Ç–µ–∫—Å—Ç –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –∏ –∑–∞–º–µ–Ω–∏–º
    # –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º replaceAllText
    requests.append({
        'replaceAllText': {
            'containsText': {
                'text': old_text,
                'matchCase': False
            },
            'replaceText': new_text
        }
    })
    
    # 3. –ó–∞–º–µ–Ω–∏—Ç—å —Ä–∞–∑–¥–µ–ª "–ü—Ä–∏—á–∏–Ω—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞"
    old_section = """–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞—Å—ã—â–µ–Ω –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –∏–¥–µ–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –æ–±—Ä–∞–∑–∞–º–∏, –Ω–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ–≤–ª–∏—è–ª–æ –±—É—Ä–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å–æ—Ü—Å–µ—Ç–µ–π –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–µ. –°–æ–∑–¥–∞–Ω–Ω–∞—è –≤ —Ü–∏—Ñ—Ä–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ "–∫—É–ª—å—Ç—É—Ä–∞ –±–µ–∑—É–ø—Ä–µ—á–Ω–æ—Å—Ç–∏" –Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞—Ç—å –æ—Ç—Ç–æ—Ä–∂–µ–Ω–∏–µ –∏, –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —É—Å—Ç–∞–ª–æ—Å—Ç—å –æ—Ç –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤. –ü–æ—ç—Ç–æ–º—É –ª—é–¥–∏ –Ω–∞—á–∞–ª–∏ –∏—Å–∫–∞—Ç—å –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –≤–æ –≤—Å–µ–º, –¥–∞–∂–µ –≤ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞—Ö, –∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ —Ç–µ—Ö –∏–ª–∏ –∏–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–∏–Ω–æ–Ω–∏–º–æ–º —á–µ—Å—Ç–Ω–æ—Å—Ç–∏. 

–ï—Å–ª–∏ –¥–∏–∑–∞–π–Ω–µ—Ä —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ç–∞–∫–∏–º–∏, –∫–∞–∫–∏–µ –æ–Ω–∏ –µ—Å—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ª–µ–¥—ã —Ä–∞–±–æ—Ç—ã –Ω–∞ –∏–∑–¥–µ–ª–∏–∏, —Ç–æ –≤—Å–µ —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –æ—â—É—â–µ–Ω–∏–µ ¬´–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏¬ª –∏ –¥–æ–≤–µ—Ä–∏—è. –í —ç–ø–æ—Ö—É, –∫–æ–≥–¥–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –Ω–∞—É—á–∏–ª—Å—è –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ—á—Ç–∏ –≤—Å–µ, –≤–∏–¥–∏–º–∞—è –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤–æ–π —Ä–æ—Å–∫–æ—à—å—é. 

–ï—â–µ –æ–¥–Ω–æ–π –ø—Ä–∏—á–∏–Ω–æ–π —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞ –∏ —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥–∞ —è–≤–ª—è—é—Ç—Å—è —ç–º–æ—Ü–∏–∏: —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä—É–∫–∞–º–∏ —á–µ–ª–æ–≤–µ–∫–∞ –æ–±—ä–µ–∫—Ç—ã –≤—ã–∑—ã–≤–∞—é—Ç –±–æ–ª—å—à–µ —ç–º–ø–∞—Ç–∏–∏. –ß–∞—Å—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –≤ –Ω—é–∞–Ω—Å–∞—Ö –Ω–∞ –∏–∑–¥–µ–ª–∏–∏ –Ω–µ –æ—à–∏–±–∫—É, –∞ —É—Å–∏–ª–∏–µ, –≤—Ä–µ–º—è, –≤–ª–æ–∂–µ–Ω–Ω–æ–µ —á–µ–ª–æ–≤–µ–∫–æ–º, –µ–≥–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–≤—è–∑—å, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –∏–¥–µ–∞–ª—å–Ω–æ –æ—Ç—à—Ç–∞–º–ø–æ–≤–∞–Ω–Ω—ã–º —Å–µ—Ä–∏–π–Ω—ã–º –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–º –∏–∑–¥–µ–ª–∏–µ–º.

–î—Ä—É–≥–æ–π –ø—Ä–∏—á–∏–Ω–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∏–≤—ã—á–µ–∫ –∏ —Ä–æ—Å—Ç–∞ –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ –∏–∑–¥–µ–ª–∏—è–º —Ä—É—á–Ω–æ–≥–æ —Ç—Ä—É–¥—É —Å—Ç–∞–ª–∞ —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —É—Å—Ç–∞–ª–æ—Å—Ç—å –æ—Ç —Ç–æ—Ç–∞–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –î–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è —Å—Ç—Ä–µ–º–ª–µ–Ω–∏—è –∫ —Ä–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–º—É –∏ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–ª–∏ —Å—Ç–µ—Ä–∏–ª—å–Ω—É—é —Å—Ä–µ–¥—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —á–µ–ª–æ–≤–µ–∫ —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è –≥–æ—Å—Ç–µ–º, –∞ –Ω–µ —Ö–æ–∑—è–∏–Ω–æ–º. –ù–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ –æ–∫—Ä—É–∂–∞—é—â–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –ø—Ä–∏ —ç—Ç–æ–º –∫–∞–∫ –±—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç  –∫–∞–∂–¥–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—à–∏–±–∞—Ç—å—Å—è, –∂–∏—Ç—å, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª. 

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ —É—Å–ª–æ–≤–∏—è—Ö –º–∞—Å—Å–æ–≤–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –¥–ª—è –º–Ω–æ–≥–∏—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–Ω–∞—á–∏–º—ã–º –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å "–∫—Ç–æ —è". –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–µ–±—è, –ø–æ–ª—å–∑—É—è—Å—å –∫–æ–Ω–≤–µ–µ—Ä–Ω—ã–º–∏ –≤–µ—â–∞–º–∏ –∏ –º—ã—Å–ª—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ –º–∏–ª–ª–∏–∞—Ä–¥—ã –ª—é–¥–µ–π –≤ –º–∏—Ä–µ, –¥–æ–≤–æ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–æ. –í —Ç–æ –∂–µ —Å–∞–º–æ–µ –≤—Ä–µ–º—è —á–∞—Å—Ç–æ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ, –Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –≤—ã–¥–µ–ª—è—é—Ç —á–µ–ª–æ–≤–µ–∫–∞, —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å, –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ –µ–≥–æ —É–≤–ª–µ—á–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è. –í–µ—â—å —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–∑–¥–∞–Ω–∏—è, —Å –≤–∏–¥–∏–º—ã–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ–º –º–∞—Å—Ç–µ—Ä–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ø–æ—Å–æ–±–æ–º –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è—Ç—å –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏—é."""
    
    new_section = """–†–∞–∑–≤–∏—Ç–∏–µ —Å–æ—Ü—Å–µ—Ç–µ–π —É–≤–µ–ª–∏—á–∏–ª–æ –æ–±—ä–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∏–¥–µ–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤.

–†—ã–Ω–æ–∫ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞—Å—Ç–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —Ä—ã–Ω–∫–∞ –æ–¥–µ–∂–¥—ã: 10% –ø—Ä–æ—Ç–∏–≤ 2-4% –≥–æ–¥ –∫ –≥–æ–¥—É.

–í—ã—Ä—É—á–∫–∞ IKEA (Ingka Group) –≤ 2024 –≥–æ–¥—É —Å–Ω–∏–∑–∏–ª–∞—Å—å[a] –Ω–∞ 2,5 –º–ª—Ä–¥ –µ–≤—Ä–æ. IKEA –æ—Å—Ç–∞–µ—Ç—Å—è –∫—Ä—É–ø–Ω–µ–π—à–∏–º –∏–≥—Ä–æ–∫–æ–º –Ω–∞ —Ä—ã–Ω–∫–µ –º–µ–±–µ–ª–∏."""
    
    requests.append({
        'replaceAllText': {
            'containsText': {
                'text': old_section[:200],  # –ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å –¥–ª—è –ø–æ–∏—Å–∫–∞
                'matchCase': False
            },
            'replaceText': new_section
        }
    })
    
    # 4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ (–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–±–µ–ª—ã)
    requests.append({
        'replaceAllText': {
            'containsText': {
                'text': '[a]https://',
                'matchCase': True
            },
            'replaceText': '[a] https://'
        }
    })
    
    requests.append({
        'replaceAllText': {
            'containsText': {
                'text': '[b]https://',
                'matchCase': True
            },
            'replaceText': '[b] https://'
        }
    })
    
    requests.append({
        'replaceAllText': {
            'containsText': {
                'text': '[c]https://',
                'matchCase': True
            },
            'replaceText': '[c] https://'
        }
    })
    
    # –í—ã–ø–æ–ª–Ω—è–µ–º batchUpdate
    if requests:
        print(f"üìù –í–Ω–æ—à—É {len(requests)} –ø—Ä–∞–≤–æ–∫...")
        print()
        
        try:
            result = docs_service.documents().batchUpdate(
                documentId=DOC_ID,
                body={'requests': requests}
            ).execute()
            
            print("‚úÖ –ü—Ä–∞–≤–∫–∏ –≤–Ω–µ—Å–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
            print(f"‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ: {result.get('replies', [])}")
            print()
            print("üìÑ –î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω: https://docs.google.com/document/d/" + DOC_ID)
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ –ø—Ä–∞–≤–æ–∫: {e}")
            return False
    else:
        print("‚ö†Ô∏è –ù–µ—Ç –ø—Ä–∞–≤–æ–∫ –¥–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è")
        return False
    
    return True

if __name__ == '__main__':
    success = edit_google_doc()
    sys.exit(0 if success else 1)


